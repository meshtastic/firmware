[env:alerts-esp32-zero]
extends = esp32s3_base
platform = espressif32
board = esp32-s3-zero
board_level = pr
board_check = true
board_upload.flash_size = 4MB
; board_build.partitions = variants/esp32s3/alerts_esp32_zero/custom_partitions.csv
upload_protocol = esptool
upload_speed = 921600
lib_deps =
  ${esp32s3_base.lib_deps}
  bblanchon/ArduinoJson @ 6.21.4
build_unflags =
  ${esp32s3_base.build_unflags}
  ; -DARDUINO_USB_MODE=1
build_flags =
  ${esp32_base.build_flags}
  -D PRIVATE_HW
  -I variants/esp32s3/alerts_esp32_zero
  -DBOARD_HAS_PSRAM
  -DLOG_LOCAL_LEVEL=ESP_LOG_INFO
  -DCORE_DEBUG_LEVEL=ARDHAL_LOG_LEVEL_INFO
  -DARDUINO_USB_CDC_ON_BOOT=1
  -DARDUINO_USB_MODE=1
  -DHAS_ALERTING=1
  ; ArduinoJson optimizations for size reduction (v6.21.4)
  -DARDUINOJSON_ENABLE_COMMENTS=0
  -DARDUINOJSON_ENABLE_NAN=0
  -DARDUINOJSON_ENABLE_INFINITY=0
  -DARDUINOJSON_ENABLE_STRING_DEDUPLICATION=0
  -DARDUINOJSON_USE_DOUBLE=0
  -DARDUINOJSON_USE_LONG_LONG=0
  -DARDUINOJSON_DEFAULT_NESTING_LIMIT=10
  -DARDUINOJSON_SLOT_OFFSET_SIZE=4
  -DARDUINOJSON_STRING_LENGTH_SIZE=4
  ; ESP32-specific optimizations
  -DARDUINOJSON_ENABLE_PROGMEM=0
  ; ESP32 power optimizations
  -DMESHTASTIC_EXCLUDE_AUDIO=1
  -DMESHTASTIC_EXCLUDE_ENVIRONMENTAL_SENSOR=1
  -DMESHTASTIC_EXCLUDE_HEALTH_TELEMETRY=1
  -DMESHTASTIC_EXCLUDE_EXTERNALNOTIFICATION=1
  -DMESHTASTIC_EXCLUDE_PAXCOUNTER=1
  -DMESHTASTIC_EXCLUDE_DETECTIONSENSOR=1
  -DMESHTASTIC_EXCLUDE_POWER_TELEMETRY=1
  -DMESHTASTIC_EXCLUDE_RANGETEST=1
  -DMESHTASTIC_EXCLUDE_REMOTEHARDWARE=1
  -DMESHTASTIC_EXCLUDE_STOREFORWARD=1
  -DMESHTASTIC_EXCLUDE_TEXTMESSAGE=1
  -DMESHTASTIC_EXCLUDE_ATAK=1
  -DMESHTASTIC_EXCLUDE_CANNEDMESSAGES=1
  -DMESHTASTIC_EXCLUDE_NEIGHBORINFO=1
  -DMESHTASTIC_EXCLUDE_TRACEROUTE=1
  -DMESHTASTIC_EXCLUDE_WAYPOINT=1
  -DMESHTASTIC_EXCLUDE_DROPZONE=1
  -DMESHTASTIC_EXCLUDE_POWERMON=1
  -DMESHTASTIC_EXCLUDE_SCREEN=1
  -DMESHTASTIC_EXCLUDE_MQTT=1
  -DMESHTASTIC_EXCLUDE_BLUETOOTH=1
  -DMESHTASTIC_EXCLUDE_GPS=1
  -DMESHTASTIC_EXCLUDE_POWER_FSM=1
  -DMESHTASTIC_EXCLUDE_POWERSTRESS=1
  ; Alerts module settings
  -DALERT_CHANNEL_NAME=\"${sysenv.ALERT_CHANNEL_NAME}\"
  -DALERT_MIN_HOUR_OF_DAY=\"${sysenv.ALERT_MIN_HOUR_OF_DAY}\"
  -DGEMINI_API_KEY=\"${sysenv.GEMINI_API_KEY}\"
  -DPERPLEXITY_API_KEY=\"${sysenv.PERPLEXITY_API_KEY}\"
  -DMISTRAL_API_KEY=\"${sysenv.MISTRAL_API_KEY}\"
  -DGROQ_API_KEY=\"${sysenv.GROQ_API_KEY}\"
