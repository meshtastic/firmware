; PlatformIO Project Configuration File
; https://docs.platformio.org/page/projectconf.html

[platformio]
default_envs = tbeam
;default_envs = tbeam-s3-core
;default_envs = tbeam0.7
;default_envs = heltec-v1
;default_envs = heltec-v2.0
;default_envs = heltec-v2.1
;default_envs = tlora-v1
;default_envs = tlora-v1
;default_envs = tlora_v1_3
;default_envs = tlora-v2
;default_envs = tlora-v2-1-1.6
;default_envs = lora-relay-v1 # nrf board
;default_envs = t-echo
;default_envs = nrf52840dk-geeksville
;default_envs = native # lora-relay-v1 # nrf52840dk-geeksville # linux # or if you'd like to change the default to something like lora-relay-v1 put that here
;default_envs = nano-g1
;default_envs = pca10059_diy_eink
;default_envs = meshtastic-diy-v1
;default_envs = meshtastic-diy-v1.1
;default_envs = m5stack-coreink
;default_envs = rak4631

extra_configs =
  arch/*/*.ini
  variants/*/platformio.ini

[env]
extra_scripts = bin/platformio-custom.py 

; note: we add src to our include search path so that lmic_project_config can override
; note: TINYGPS_OPTION_NO_CUSTOM_FIELDS is VERY important.  We don't use custom fields and somewhere in that pile
; of code is a heap corruption bug!
; FIXME: fix lib/BluetoothOTA dependency back on src/ so we can remove -Isrc
build_flags = -Wno-missing-field-initializers
  -Wno-format 
  -Isrc -Isrc/mesh -Isrc/gps -Isrc/buzz -Wl,-Map,.pio/build/output.map 
  -DUSE_THREAD_NAMES
  -DTINYGPS_OPTION_NO_CUSTOM_FIELDS
  -DPB_ENABLE_MALLOC=1

monitor_speed = 115200

lib_deps =
  https://github.com/meshtastic/esp8266-oled-ssd1306.git#53580644255b48ebb7a737343c6b4e71c7e11cf2 ; ESP8266_SSD1306 
  mathertel/OneButton@^2.0.3 ; OneButton library for non-blocking button debounce
  1202 ; CRC32, explicitly needed because dependency is missing in the ble ota update lib
  https://github.com/meshtastic/arduino-fsm.git
  https://github.com/meshtastic/TinyGPSPlus.git
  Wire ; explicitly needed here because the AXP202 library forgets to add it
  SPI
  https://github.com/meshtastic/ArduinoThread.git#72921ac222eed6f526ba1682023cee290d9aa1b3
  nanopb/Nanopb@^0.4.6

; Used for the code analysis in PIO Home / Inspect
check_tool = cppcheck
check_skip_packages = yes

; Common settings for conventional (non Portduino) Arduino targets
[arduino_base]
framework = arduino
lib_deps =
  ${env.lib_deps}
  ; Portduino is using meshtastic fork for now
  https://github.com/jgromes/RadioLib.git

build_flags = ${env.build_flags} -Os 
# -DRADIOLIB_GODMODE
build_src_filter = ${env.build_src_filter} -<platform/portduino/>

; Common libs for communicating over TCP/IP networks such as MQTT 
[networking_base]
lib_deps =
  PubSubClient
  meshtastic/json11@^1.0.2

; Common libs for environmental measurements in telemetry module 
; (not included in native / portduino)
[environmental_base]
lib_deps =
  adafruit/Adafruit BusIO@^1.11.4
  adafruit/Adafruit Unified Sensor@^1.1.4
  adafruit/Adafruit BMP280 Library@^2.6.3
  adafruit/Adafruit BME280 Library@^2.2.2
  adafruit/Adafruit BME680 Library@^2.0.1
  adafruit/Adafruit MCP9808 Library@^2.0.0
  adafruit/Adafruit INA260 Library@^1.5.0
  adafruit/Adafruit INA219@^1.2.0
  